// ==UserScript==
// @name         Hide Chinese YouTube Recommendations 3.0
// @namespace    http://tampermonkey.net/
// @version      2.0
// @description  Hide videos with Chinese characters on YouTube
// @match        https://www.youtube.com/*
// @grant        none
// ==/UserScript==

(function () {
    'use strict';

    function analyzeChinese(text) {
        const chineseOnly = (text.match(/[\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]/g) || []).length;
        const hiragana = (text.match(/[\u3040-\u309F]/g) || []).length;
        const katakana = (text.match(/[\u30A0-\u30FF]/g) || []).length;
        const total = text.length;
        const kanjiSet = new Set("æ—¥ä¸€å›½ä¼šäººå¹´å¤§åäºŒæœ¬ä¸­é•·å‡ºä¸‰åŒæ™‚æ”¿äº‹è‡ªè¡Œç¤¾è¦‹æœˆåˆ†è­°å¾Œå‰æ°‘ç”Ÿé€£äº”ç™ºé–“å¯¾ä¸Šéƒ¨æ±è€…å…šåœ°åˆå¸‚æ¥­å†…ç›¸æ–¹å››å®šä»Šå›žæ–°å ´é‡‘å“¡ä¹å…¥é¸ç«‹é–‹æ‰‹ç±³åŠ›å­¦å•é«˜ä»£æ˜Žå®Ÿå††é–¢æ±ºå­å‹•äº¬å…¨ç›®è¡¨æˆ¦çµŒé€šå¤–æœ€è¨€æ°ç¾ç†èª¿ä½“åŒ–ç”°å½“å…«å…­ç´„ä¸»é¡Œä¸‹é¦–æ„æ³•ä¸æ¥ä½œæ€§çš„è¦ç”¨åˆ¶æ²»åº¦å‹™å¼·æ°—å°ä¸ƒæˆæœŸå…¬æŒé‡Žå”å–éƒ½å’Œçµ±ä»¥æ©Ÿå¹³ç·åŠ å±±æ€å®¶è©±ä¸–å—åŒºé ˜å¤šçœŒç¶šé€²æ­£å®‰è¨­ä¿æ”¹æ•°è¨˜é™¢å¥³åˆåŒ—åˆæŒ‡æ¨©å¿ƒç•Œæ”¯ç¬¬ç”£çµç™¾æ´¾ç‚¹æ•™å ±æ¸ˆæ›¸åºœæ´»åŽŸå…ˆå…±å¾—è§£åäº¤è³‡äºˆå·å‘éš›æŸ»å‹é¢å§”å‘Šè»æ–‡åå…ƒé‡è¿‘åƒè€ƒåˆ¤èªç”»æµ·å‚å£²åˆ©çµ„çŸ¥æ¡ˆé“ä¿¡ç­–é›†åœ¨ä»¶å›£åˆ¥ç‰©å´ä»»å¼•ä½¿æ±‚æ‰€æ¬¡æ°´åŠå“æ˜¨è«–è¨ˆæ­»å®˜å¢—ä¿‚æ„Ÿç‰¹æƒ…æŠ•ç¤ºå¤‰æ‰“ç”·åŸºç§å„å§‹å³¶ç›´ä¸¡æœé©ä¾¡å¼ç¢ºæ‘æé‹çµ‚æŒ™æžœè¥¿å‹¢æ¸›å°åºƒå®¹å¿…å¿œæ¼”é›»æ­³ä½äº‰è«‡èƒ½ç„¡å†ä½ç½®ä¼çœŸæµæ ¼æœ‰ç–‘å£éŽå±€å°‘æ”¾ç¨Žæ¤œè—¤ç”ºå¸¸æ ¡æ–™æ²¢è£çŠ¶å·¥å»ºèªžçƒå–¶ç©ºè·è¨¼åœŸä¸Žæ€¥æ­¢é€æ´ä¾›å¯å½¹æ§‹æœ¨å‰²èžèº«è²»ä»˜æ–½åˆ‡ç”±èª¬è»¢é£Ÿæ¯”é›£é˜²è£œè»Šå„ªå¤«ç ”åŽæ–­äº•ä½•å—çŸ³è¶³é•æ¶ˆå¢ƒç¥žç•ªè¦è¡“è­·å±•æ…‹å°Žé®®å‚™å®…å®³é…å‰¯ç®—è¦–æ¡å¹¹ç‹¬è­¦å®®ç©¶è‚²å¸­è¼¸è¨ªæ¥½èµ·ä¸‡ç€ä¹—åº—è¿°æ®‹æƒ³ç·šçŽ‡ç—…è¾²å·žæ­¦å£°è³ªå¿µå¾…è©¦æ—è±¡éŠ€åŸŸåŠ©åŠ´ä¾‹è¡›ç„¶æ—©å¼µæ˜ é™è¦ªé¡ç›£ç’°é¨“è¿½å¯©å•†è‘‰ç¾©ä¼åƒå½¢æ™¯è½æ¬§æ‹…å¥½é€€æº–è³žè¨´è¾ºé€ è‹±è¢«æ ªé ­æŠ€ä½Žæ¯ŽåŒ»å¾©ä»•åŽ»å§¿å‘³è² é–£éŸ“æ¸¡å¤±ç§»å·®è¡†å€‹é–€å†™è©•èª²æœ«å®ˆè‹¥è„³æ¥µç¨®ç¾Žå²¡å½±å‘½å«ç¦è”µé‡æœ›æ¾éžæ’ƒä½æ ¸è¦³å¯Ÿæ•´æ®µæ¨ªèžåž‹ç™½æ·±å­—ç­”å¤œè£½ç¥¨æ³éŸ³ç”³æ§˜è²¡æ¸¯è­˜æ³¨å‘¼æ¸‰é”è´ˆæ™ºæ¡ç…§å®™é…’ä¿ŠéŠ­è–„å ‚æ¸‹ç¾¤éŠƒæ‚²ç§’æ“æºå¥¥è¨ºè©°è¨—æ™´æ’®èª•ä¾µæ‹¬æŽ›è¬åŒå­åˆºåˆ°é§†å¯é€æ´¥å£ç¨²ä»®æš—è£‚æ•é³¥ç´”æ˜¯é£¯æŽ’è£•å …è¨³ç›—èŠç¶±å¸å…¸è³€æ‰±é¡§å¼˜çœ‹è¨Ÿæˆ’ç¥‰èª‰æ­“å‹‰å¥å‹§é¨’ç¿Œé™½é–¥ç”²å¿«ç¸„ç‰‡éƒ·æ•¬æºå…æ—¢è–¦éš£æ‚©è¯æ³‰å¾¡ç¯„éš å†¬å¾³çš®å“²æ¼æ‰é‡Œé‡ˆå·±è’è²¯ç¡¬å¦¥å¨è±ªç†Šæ­¯æ»žå¾®éš†åŸ‹ç—‡æš«å¿ å€‰æ˜¼èŒ¶å½¦è‚æŸ±å–šæ²¿å¦™å”±ç¥­è¢‹é˜¿ç´¢èª å¿˜è¥²é›ªç­†å¹è¨“æ‡‡æµ´ä¿³ç«¥å®æŸ„é©šéº»å°èƒ¸å¨˜ç ‚æŽå¡©æµ©èª¤å‰¤ç€¬è¶£é™¥æ–Žè²«ä»™æ…°è³¢åºå¼Ÿæ—¬è…•å…¼è–æ—¨å³æ´—æŸ³èˆŽå½è¼ƒè¦‡å…†åºŠç•‘æ…£è©³æ¯›ç·‘å°ŠæŠµè„…ç¥ç¤¼çª“æŸ”èŒ‚çŠ æ——è·é›…é£¾ç¶²ç«œè©©æ˜”ç¹æ®¿æ¿ƒç¿¼ç‰›èŒ¨æ½Ÿæ•µé­…å«Œé­šæ–‰æ¶²è²§æ•·æ“è¡£è‚©åœé›¶é…¸å…„ç½°æ€’æ»…æ³³ç¤Žè…ç¥–å¹¼è„šè±è·æ½®æ¢…æ³Šå°½æ¯åƒ•æ¡œæ»‘å­¤é»„ç…•ç‚Žè³ å¥å¯¿é‹¼é ‘ç”˜è‡£éŽ–å½©æ‘©æµ…åŠ±æŽƒé›²æŽ˜ç¸¦è¼è“„è»¸å·¡ç–²ç¨¼çž¬æ¨çš†ç ²è»Ÿå™´æ²ˆèª‡ç¥¥ç‰²ç§©å¸å®å”†é³´é˜»æ³°è³„æ’²å‡å €è…¹èŠçµžä¹³ç…™ç¸å”¯è†¨çŸ¢è€æ‹å¡¾æ¼ç´…æ…¶çŒ›èŠ³æ‡²éƒŠå‰£è…°ç‚­è¸Šå¹Œå½°æ£‹ä¸å†Šæ’çœ æšå†’ä¹‹å‹‡æ›½æ¢°å€«é™³æ†¶æ€–çŠ¬èœè€³æ½œçæ¢¨ä»å…‹å²³æ¦‚æ‹˜å¢“é»™é ˆåé›°åµé‡æ¹–è«®ç‹­å–«å“å¹²é ‚è™«åˆ·äº€ç³§æ¢¶æ¹¯ç®±ç°¿ç‚‰ç‰§æ®Šæ®–è‰¦æº¶è¼©ç©´å¥‡æ…¢é¶´è¬€æš–æ˜Œæ‹æœ—ä¸ˆé‰±å¯›è¦†èƒžæ³£æ¶™éš”æµ„åŒ¹æ²¡æš‡è‚ºå­«è²žé–é‘‘é£¼é™°éŠ˜é‹­éšçƒˆå°‹æ¸•ç¨¿æžä¸¹å•“ä¹Ÿä¸˜æ£Ÿå£Œæ¼«çŽ„ç²˜æ‚Ÿèˆ—å¦Šå¡—ç†Ÿè»’æ—­æ©æ¯’é¨°å¾€è±†é‚æ™©ç‹‚å«æ ƒå²é™›ç·¯åŸ¹è¡°è‰‡å±ˆå¾„æ·¡æŠ½æŠ«å»·éŒ¦å‡†æš‘æ‹ç£¯å¥¨å¦¹æµ¸å‰°èƒ†æ°·ç¹Šé§’ä¹¾è™šæ£’å¯’å­œéœŠå¸³æ‚”è«­ç¥ˆæƒ¨è™ç¿»å¢œæ²¼æ®è‚¥å¾ç³–æ­å§‰é«ªå¿™ç›¾è„ˆæ»æ‹¾è»Œä¿µå¦¨ç›§ç²‰æ“¦é¯¨æ¼¢ç³¸è˜è«¾é›·æ¼‚æ‡å‹˜ç¶¿æ ½æ‰æ‹ç¬ é§„æ·»æ±—å† æ–œéŠ…é¡è¡æµªäºœè¦§è©å£‡å‹²é­”é…¬ç´«æ¹¿æ›™ç´‹å¸å¥®è¶™æ¬„é€¸æ¶¯æ‹“çœ¼ç“¶ç„ç­‘å°šé˜œå½«å’²ç©é¡•å·§çŸ›åž£å¬æ¬ºé‡£ç¼¶è©ç²§éš»è‘›è„‚ç²›æ —æ„šè’¸å˜‰é­æž¶ç¯ é¬¼åº¶è‚Œç¨šé´è…æ»‹å¹»ç…®å§«èª“è€•æŠŠè·µå‘ˆç–Žä»°éˆæ¥å‰›ç–¾å¾ç •è¬¡å«è¬™åŽå˜†ä¿£èŒéŽŒå·£æ³¥é »ç´ç­æ·µæ£šæ½”é…·å®°å»Šå¯‚è¾°éš…å¶éœžä¼ç¯æŸè¾›ç£¨ç¢ä¿—æ¼ é‚ªæ™¶è¾»éº¦å¢¨éŽ®æ´žå±¥åŠ£é‚£æ®´å¨ å¥‰æ†‚æœ´äº­å§“æ·³è»ç­’é¼»å¶‹æ€ªç²’è©žé³©æŸ´å‰é…”æƒœç©«ä½³æ½¤æ‚¼ä¹èƒƒè©²èµ´æ¡‘æ¡‚é«„è™Žç›†æ™‹ç©‚å£®å ¤é£¢å‚ç–«ç´¯ç—´æ¬ç•³æ™ƒç™’æ¡å¯¸éƒ­æœºå°¿å‡¶åå®´é·¹è³“è™œè†šé™¶é˜æ†¾ç•¿çŒªç´˜ç£å¼¥æ˜†ç²—è¨‚èŠ½å°»åº„å‚˜æ•¦é¨Žå¯§æ¿¯å¾ªå¿ç£çŒ«æ€ å¦‚å¯®ç¥éµ¬å¡”æ²¸é‰›ç å‡è‹—ç£å“€è·³ç°åŒ è“åž‚è›‡æ¾„ç¸«åƒ§å¹¾çœºå”äº˜å‘‰å‡¡æ†©é„­èŠ¦é¾åª›æºæ­åˆˆç¡éŒ¯ä¼¯å¸½ç¬¹ç©€æŸ¿é™µéœ§é­‚æž¯å¼Šé‡§å¦ƒèˆ¶é¤“è…Žçª®æŽŒéº—ç¶¾è‡­é‡œæ‚¦åˆƒç¸›æš¦å®œç›²ç²‹è¾±æ¯…è½„çŒ¿å¼¦å¶Œç¨”çª’ç‚Šæ´ªæ‘‚é£½å‡½å†—æ¶¼æ¡ƒç‹©èˆŸè²æœ±æ¸¦ç´³æž¢ç¢‘é›åˆ€é¼“è£¸é´¨ç¬¦çŒ¶å¡Šæ—‹å¼“å¹£è†œæ‰‡è„‡è…¸æ†Žæ§½é‹æ…ˆçš¿è‚¯æ¨‹æ¥Šä¼é§¿æ¼¬ç‡¥ç³¾äº®å¢³åªç•œç´ºæ…Œå¨¯å¾æ¤¿èˆŒç¾…åŠå³¡ä¿¸åŽ˜å³°åœ­é†¸è“®å¼”ä¹™å€¶æ±å°¼éå ºè¡¡å‘†è–«ç“¦çŒŸç¾Šçªªæ¬¾é–²é›€åµå–æ•¢ç• èƒŽé…µæ†¤è±šé®æ‰‰ç¡«èµ¦æŒ«æŒŸçªƒæ³¡ç‘žåˆæ…¨ç´¡æ¨è‚ªæ‰¶æˆ¯ä¼å¿Œæ¿å¥”æ–—è˜­è’²è¿…è‚–é‰¢æœ½æ®»äº«ç§¦èŒ…è—©æ²™è¼”æ›‡åª’é¶ç¦…å˜±èƒ´ç²•å†¨è¿­æŒ¿æ¹˜åµæ¤Žç˜å °ç…å§œçµ¹é™ªå‰–è­œéƒæ‚ æ·‘å¸†æšé·²å‚‘æ¥ ç¬›èŠ¥å…¶çŽ²å¥´èª°éŒ æ‹³ç¿”é·æ‹™ä¾å°ºå³ ç¯¤è‚‡æ¸‡æ¦Žä¿ºåŠ‰å¹¡è«å”é›Œäº¨å ªå™é…¢åŸé€“ç—•å¶ºè¢–ç”šå–¬å´”å¦–çµç¶è¯è˜‡é—‡å´‡æ¼†å²¬ç™–æ„‰å¯…æ‰ç¤ä¹ƒæ´²å±¯æ¨½æ¨ºæ§™è–©å§»å·Œæ·€éº¹è³­æ“¬å¡€å”‡ç¦é–‘èƒ¡å¹½å³»æ›¹å“¨è© ç‚’å±å‘ä¾®é‹³æŠ¹å°‰æ§»éš·ç¦è¶é…ªèŒŽæ±Žé ƒå¸¥æ¢é€æ»´æ±½è¬Žç¢ç®•åŒ¿çˆªèŠ­é€—è‹«éµè¥Ÿè›æ¥¢è•‰å…œå¯¡ç‰ç—¢åº¸æœ‹å‘å§‘çƒè—åƒ‘è³Šæ¾å¥„è‡¼ç•”é¼å”„å­”æ©˜æ¼±å‘‚æ¡§æ‹·å®‹å¬¢è‹‘å·½æœæ¸“ç¿è—å»‰ç‰™è¬¹çž³æ¹§æ¬£çª¯è¤’é†œé­ç¯‡å‡æ­¤å³¯æ®‰ç…©å·´ç¦Žæž•åŠ¾è©å •ä¸¼ç§Ÿæªœç¨œç‰Ÿæ¡Ÿæ¦ŠéŒ«èæƒ§å€­å©¿æ…•å»ŸéŠšæ–ç½·çŸ¯æŸå›šé­è–®è™¹é´»æ³Œæ–¼èµ³æ¼¸é€¢å‡§éµœåºµè†³èšŠè‘µåŽ„è—»è¬ç¦„å­Ÿé´ˆç‹¼å«¡å‘ªæ–¬å°–ç¿«å¶½å°­æ€¨å¿ä¸²å·²åš‡å·³å‡¸æš¢è…«ç²Ÿç‡•éŸ»ç¶´åŸ´éœœé¤…é­¯ç¡ç‰¡ç®¸å‹…èŠ¹æè¿¦æ£ºå„’é³³é¦¨æ–‘è”­ç„‰æ…§ç¥‡æ‘¯æ„é·ºæ¥¼å½¬è¢´åŒ¡çœ‰è‹…è®ƒå°¹æ¬½è–ªæ¹›å †ç‹è¤é´Žç€‹æŒºè³œåµ¯é›ä½ƒç¶œç¹•ç‹›å£·æ©¿æ “ç¿ é®ŽèŠ¯èœœæ’­æ¦›å‡¹è‰¶å¸–ä¼ºæ¡¶æƒ£è‚¡åŒ‚éžè”¦çŽ©è±æ¢¯é›«çµ†éŒ¬æ¹Šèœ‚éš¼èˆµæ¸šç‚ç…¥è¡·é€æ–¥ç¨€ç™Œå³¨å˜˜æ—›ç¯­èŠ™è©”çšé››å¨¼ç¯†é®«æ¤…æƒŸç‰Œå®•å–§ä½‘è’‹æ¨Ÿè€€é»›å±æ«›æ¸¥æŒ¨æ†§æ¿¡æ§å®µè¥„å¦„æƒ‡è›‹è„©ç¬˜å®ç”«é…Œèš•å£•å¬‰å›ƒè’¼é¤Œç°—å³™ç²¥èˆ˜éŠ•é„’èœ·æš‰æ§é ’åªè‚¢ç®æª€éµ å‡±å½—è¬„è«Œæ¨«å™‚è„Šç‰æ¢“æ´›é†ç ¦ä¸‘ç¬è•¨å™ºæŠ’å—£éšˆå¶å‡„æ±çµ¢å©å«‰æœ”è”¡è†é¾ä»‡ä¼½å¤·æ£çž‘ç•æŠ„æ­å¯“éººæˆ´çˆ½è£¾é»Žæƒ°åé¼è›®å¡™å†´æ—ºè‘¦ç¤’å’¸èŒé¥—æ­ªå†¥å²å£±ç‘ éŸ®æ¼•æµè–”è† å…çœžè’™è•ƒå‘‘ä¾¯ç¢“èŒ—éº“ç€•è’”é¯‰ç«ªå¼§ç¨½ç˜¤æ¾¤æº¥é¥è¹´æˆ–è¨ƒçŸ©åŽ¦å†¤å‰¥èˆœä¾ è´…æ–è“‹ç•å–‰æ±ªçŒ·ç‘›æœæ›¼é™„å½ªæ’šå™›å¯æ¡æ’«å–‹ä½†æº¢é—Šè—æµ™å½­æ·˜å‰ƒæƒç¶ºå¾˜å··ç«¿èŸ¹èŠ‹è¢èˆ©æ‹­èŒœå‡Œé ¬åŽ¨çŠ€ç°‘çš“ç”¦æ´¸æ¯¬æª„å§šè›­å©†å¢æ¤™è½Ÿè´‹æ´’è²°å„²ç·‹è²¼è«œé¯›è“¼ç”•å–˜æ€œæºœé‚‘é‰¾å€£ç¢§ç‡ˆè«¦ç…Žç“œç·»å“ºæ§Œå•„ç©£å—œå•ç½µé…‰è¹„é šèƒšç‰¢ç³žæ‚ŒåŠæ¥•é®­ä¹žå€¹å—…è©«é±’è”‘è½é†¤æƒšå»£è—æŸšèˆ›ç¸žè¬³æžé±—ç¹­é‡˜å¼›ç‹¸å£¬ç¡¯è¦".split(""));
        let KanjiCount = 0;
        for (const ch of text) {
            if (kanjiSet.has(ch)) {
                KanjiCount++;
            }
        }
        const ratio = (chineseOnly - KanjiCount) / total;
        const isChinese = chineseOnly >= 2 && ratio > 0.1 && (hiragana + katakana <= 1);
        return { isChinese, ratio };
    };

    function insertHiddenInfo(renderer, title, ratio) {
        const container = document.createElement('div');
        container.className = 'chinese-hide-info';

        Object.assign(container.style, {
            background: '#222',
            color: '#f55',
            border: '1px dashed #555',
            padding: '10px',
            marginBottom: '10px',
            fontSize: '14px',
            borderRadius: '6px',
            lineHeight: '1.5',
            whiteSpace: 'normal'
        });

        const line1 = document.createElement('div');
        const strong1 = document.createElement('strong');
        strong1.textContent = 'è¯¥è§†é¢‘åŒ…å«ä¸­æ–‡å†…å®¹ï¼Œå·²è¢«éšè—';
        line1.textContent = 'ðŸš« ';
        line1.appendChild(strong1);

        const line2 = document.createElement('div');
        const strong2 = document.createElement('strong');
        strong2.textContent = 'æ ‡é¢˜ï¼š';
        line2.textContent = 'ðŸ“ ';
        line2.appendChild(strong2);
        line2.appendChild(document.createTextNode(` ${title}`));

        const line3 = document.createElement('div');
        const strong3 = document.createElement('strong');
        strong3.textContent = 'æ±‰å­—å æ¯”ï¼š';
        line3.textContent = 'ðŸ“Š ';
        line3.appendChild(strong3);
        line3.appendChild(document.createTextNode(` ${(ratio * 100).toFixed(1)}%`));

        container.appendChild(line1);
        container.appendChild(line2);
        container.appendChild(line3);

        renderer.parentNode.insertBefore(container, renderer);
    };



    function getVideoTitleElements() {
        const selectors = [
            'a#video-title',
            'yt-formatted-string#video-title',
            'a.yt-simple-endpoint.style-scope.ytd-grid-video-renderer',
            'a.yt-lockup-metadata-view-model-wiz__title',
            'h3.yt-lockup-title > a',
            'a[href^="/watch"]:not([aria-hidden="true"])',
        ];

        const elements = [];
        selectors.forEach(selector => {
            document.querySelectorAll(selector).forEach(el => {
                if (el.textContent && el.textContent.trim().length >= 5) {
                    elements.push(el);
                }
            });
        });

        return elements;
    };

    const removeChineseVideosByTitle = () => {
        const titles = getVideoTitleElements();

        titles.forEach(titleElement => {
            const text = titleElement.textContent.trim();
            const { isChinese, ratio } = analyzeChinese(text);
            if (!isChinese) return;

            const renderer = titleElement.closest('ytd-rich-item-renderer, ytd-video-renderer, div#content, ytd-grid-video-renderer');
            if (renderer && !renderer.hasAttribute('data-checked')) {
                console.log("[HIDE]", text);
                renderer.setAttribute('data-checked', 'true');
                renderer.style.display = 'none';
                insertHiddenInfo(renderer, text, ratio);
            }
        });
    };

    const observer = new MutationObserver(() => removeChineseVideosByTitle());
    observer.observe(document.body, { childList: true, subtree: true });

    document.addEventListener("DOMContentLoaded", removeChineseVideosByTitle);
    setInterval(removeChineseVideosByTitle, 2000);
})();
